!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e=e.L||(e.L={}),e=e.Control||(e.Control={}),e.LineStringSelect=t()}}(function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return r(i?i:t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,i){(function(i){/**
 * Leaflet LineString selection control
 * @license MIT
 * @author Alexander Milevski <info@w8r.name>
 * @preserve
 */
var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null;n.Control.LineStringSelect=e.exports=t("./src/select")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./src/select":5}],2:[function(t,e,i){var n=t("./marker"),r=n.extend({options:{radiusRatio:1.2},onAdd:function(t){this.on("mouseover",this._onMouseOver,this).on("mouseout",this._onMouseOut,this),n.prototype.onAdd.call(this,t)},onRemove:function(t){this.off("mouseover",this._onMouseOver,this).off("mouseout",this._onMouseOut,this),n.prototype.onRemove.call(this,t)},_onMouseOver:function(){this.setRadius(this.options.radius*this.options.radiusRatio)},_onMouseOut:function(){this.setRadius(this.options.radius/this.options.radiusRatio)}});e.exports=r},{"./marker":4}],3:[function(t,e,i){function n(t,e){var i=t[0]-e[0],n=t[1]-e[1];return i*i+n*n}function r(t,e){return Math.sqrt(n(t,e))}function o(t,e,i){var r=i[0]-e[0],o=i[1]-e[1],s=r*r+o*o,a=s&&((t[0]-e[0])*r+(t[1]-e[1])*(i[1]-e[1]))/s;return n(t,a<=0?e:a>=1?i:[e[0]+a*r,e[1]+a*o])}function s(t,e,i){var n=i[0]-e[0],r=i[1]-e[1],o=t[0]-e[0],s=t[1]-e[1],a=(o*n+s*r)/(n*n+r*r);return a<0?0:a>1?1:a}function a(t,e,i){var n=s(t,e,i),r=i[0]-e[0],o=i[1]-e[1],a=[e[0]+n*r,e[1]+n*o];return a}function l(t,e,i){return t+i*(e-t)}function h(t,e,i,n){var r=i/n;return[l(t[0],e[0],r),l(t[1],e[1],r)]}e.exports={pointSegmentDistance:o,closestPointOnSegment:a,pointOnSegment:h,distance:r}},{}],4:[function(t,e,i){(function(t){var i="undefined"!=typeof window?window.L:"undefined"!=typeof t?t.L:null,n=i.CircleMarker.extend({show:function(){return this._container.style.visibility="",this},hide:function(){return this._container.style.visibility="hidden",this}});e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(t,e,i){(function(i){var n="undefined"!=typeof window?window.L:"undefined"!=typeof i?i.L:null,r=t("./geometry"),o=t("./marker"),s=t("./endpoint"),a=t("./selection"),l=i.rbush||t("rbush"),h=n.Control.extend({includes:n.Mixin.Events,statics:{Selection:a,Endpoint:s,ControlMarker:o},options:{startMarkerClass:"select-marker select-start-marker",endMarkerClass:"select-marker select-end-marker",movingMarkerClass:"select-marker select-moving-marker",name:"leaflet-linestring-select",lineWeight:4,lineTolerance:n.Browser.touch?10:5,movingMarkerStyle:{fillColor:"#fff",fillOpacity:1,weight:2,opacity:.5,color:"#000"},endpointStyle:{radius:5,color:"#111",fillColor:"#fff",fillOpacity:1},selectionStyle:{color:"#0ff",opacity:1},useTouch:n.Browser.touch,position:"topright"},initialize:function(t){t=t||{},this._startMarker=null,this._endMarker=null,this._movingMarker=null,this._feature=null,this._layer=null,this._selection=null,this._tolerance=null,n.Util.setOptions(this,t),n.Control.prototype.initialize.call(this,this.options)},onAdd:function(t){var e=this._container=n.DomUtil.create("div",this.options.containerClass);return n.DomEvent.disableClickPropagation(e).disableScrollPropagation(e),e},onRemove:function(t){this.disable()},enable:function(t){return this._layer=t.layer,this._feature=t.feature||t.layer.toGeoJSON(),this._createHandles(),this._buildTree(),this._layer.on("click",this._onLayerClick,this),this._map.on("moveend zoomend resize",this._calculatePointerTolerance,this).on("mousemove touchmove",this._onMousemove,this).on(n.Draggable.START.join(" "),this._onMouseDown,this).on("click contextmenu",this._onMapClick,this),this._calculatePointerTolerance(),this},disable:function(){return this.reset(),this._map.removeLayer(this._movingMarker),this._movingMarker=null,this._layer.off("click",this._onLayerClick,this),this._map.off("moveend zoomend resize",this._calculatePointerTolerance,this).off("mousemove touchmove",this._onMousemove,this).off(n.Draggable.START.join(" "),this._onMouseDown,this).off("click contextmenu",this._onMapClick,this),this._feature=null,this._layer=null,this},reset:function(){return this._startMarker&&(this._map.removeLayer(this._startMarker),this._startMarker=null),this._endMarker&&(this._map.removeLayer(this._endMarker),this._endMarker=null),this._selection&&(this._map.removeLayer(this._selection),this._selection=null),this._movingMarker.setLatLng(this._layer.getLatLngs()[0]),this.options.useTouch||this._movingMarker.show(),this.fire("reset"),this},getSelection:function(){return this._selection?this._selection.getLatLngs():null},toGeoJSON:function(){return this._selection?this._selection.toGeoJSON():null},selectMeters:function(t,e){if(this.reset(),t<0||e<0)throw new Error("Can't use negative meter values for distance selection");var i=this._pointAtM(t),n=this._pointAtM(e);return i=this._getNearestPoint(i),n=this._getNearestPoint(n),this._setPoint(i,i.start,i.end),this._setPoint(n,n.start,n.end),this},movingMarkerFactory:function(t,e){return new o(t,e)},endpointFactory:function(t,e,i){return new s(t,e)},selectionFactory:function(t,e,i){return new a(t,e,i)},_distance:function(t,e){return this.options.distance?this.options.distance(t,e):new n.LatLng(t[1],t[0]).distanceTo(new n.LatLng(e[1],e[0]))},_getProjectedPoint:function(t){return this.options.getProjectedPoint?this.options.getProjectedPoint.call(this,t):(t=this._map.options.crs.latLngToPoint(new n.LatLng(t[1],t[0]),this._map.getMaxZoom()),[t.x,t.y])},_pointAtSegmentM:function(t,e,i){var o=this._distance(t,e);t=this._getProjectedPoint(t),e=this._getProjectedPoint(e);var s=r.pointOnSegment(t,e,i,o);return n.point(s)},_pointAtM:function(t){var e,i,r,o=this._feature.geometry.coordinates,s=0;for(i=1,r=o.length;i<r;i++){var a=this._distance(o[i-1],o[i]);if(!(s+a<=t))break;s+=a}return s===t||i===o.length?(e=o[i-1],new n.LatLng(e[1],e[0])):(e=this._pointAtSegmentM(o[i-1],o[i],t-s),this._map.options.crs.pointToLatLng(e,this._map.getMaxZoom()))},_calculatePointerTolerance:function(){var t=this._map.getCenter(),e=.5*this.options.lineWeight+this.options.lineTolerance,i=this._map.layerPointToLatLng(this._map.latLngToLayerPoint(t).add(new n.Point(e,e)));this._tolerance=new n.LatLng(Math.abs(t.lat-i.lat),Math.abs(t.lng-i.lng))},_createHandles:function(){var t=n.latLng(this._layer._latlngs[0]),e=this.options.movingMarkerStyle;e.radius=this.options.lineTolerance,e.className=this.options.movingMarkerClass,this._movingMarker=this.movingMarkerFactory(t,e).addTo(this._map),this._movingMarker.on("click",this._onMovingMarkerClick,this),this.options.useTouch&&this._movingMarker.hide()},_onMovingMarkerClick:function(t){this._setPoint(this._movingMarker.getLatLng(),this._movingMarker.start,this._movingMarker.end)},_onLayerClick:function(t){var e=this._getNearestPoint(t.latlng);e?this._setPoint(n.latLng(e),e.start,e.end):this._setPoint(t.latlng)},_onMapClick:function(t){if(!this._endMarker){var e=this._map.latLngToLayerPoint(t.latlng),i=this._movingMarker.getLatLng();if(this.options.useTouch){var o=this._getNearestPoint(t.latlng);o&&(i=n.latLng(o),this._movingMarker.setLatLng(i))}var s=this._map.latLngToLayerPoint(i),a=r.distance([e.x,e.y],[s.x,s.y]);a<=2*this.options.lineTolerance&&(i=this._getNearestPoint(i),this._setPoint(i,i.start,i.end))}},_setPoint:function(t,e,i){var n=this.options.endpointStyle;this._startMarker?this._endMarker||(n.className=this.options.endMarkerClass,this._endMarker=this.endpointFactory(t,n,!0).addTo(this._map),this._endMarker.start=e,this._endMarker.end=i,this._movingMarker.hide(),this.fire("select:end",{latlng:t}),this._startMarker&&this._endMarker&&this._onSelect()):(n.className=this.options.startMarkerClass,this._startMarker=this.endpointFactory(t,n,!1).addTo(this._map),this._startMarker.start=e,this._startMarker.end=i,this.fire("select:start",{latlng:t}))},_getPointerBounds:function(t){var e=this._tolerance.lng,i=this._tolerance.lat;return{minY:t.lat-i,minX:t.lng-e,maxY:t.lat+i,maxX:t.lng+e}},_onMouseDown:function(t){var e=t.originalEvent.target||t.originalEvent.srcElement;if(this.options.useTouch){var i;this._startMarker&&(i=this._map.latLngToContainerPoint(this._startMarker.getLatLng()),r.distance([t.containerPoint.x,t.containerPoint.y],[i.x,i.y])<=2*this.options.lineTolerance&&(e=this._startMarker._path)),this._endMarker&&(i=this._map.latLngToContainerPoint(this._endMarker.getLatLng()),r.distance([t.containerPoint.x,t.containerPoint.y],[i.x,i.y])<=2*this.options.lineTolerance&&(e=this._endMarker._path))}this._startMarker&&this._startMarker._path===e?(this._dragging=this._startMarker,this._static=this._endMarker):this._endMarker&&this._endMarker._path===e&&(this._dragging=this._endMarker,this._static=this._startMarker),this._dragging&&(n.DomEvent.stop(t),this._dragging._dragging=!0,n.Draggable._disabled=!0,this._map.dragging.disable(),this._map.once("mouseup",this._stopHandlerDrag,this))},_stopHandlerDrag:function(t){this._dragging&&(i.clearTimeout(this._dragTimer),n.Draggable._disabled=!1,this._map.dragging.enable(),this._dragging._dragging=null,this._dragging=null,this._onDragStopped(this._dragging,t.latlng))},_onDragStopped:function(t,e){this._startMarker&&this._endMarker&&this._onSelect()},_checkEndPoints:function(){if(this._startMarker.start>this._endMarker.start){var t=this._startMarker;this._startMarker=this._endMarker,this._endMarker=t}},_onSelect:function(){this._checkEndPoints();var t=this._startMarker.end,e=this._endMarker.start,i=this._layer._latlngs.slice(t,e+1);i.unshift(this._startMarker.getLatLng()),i.push(this._endMarker.getLatLng()),this._selection?(this._selection._latlngs=i,this._selection.updatePathFromSource(this._startMarker.end,this._endMarker.start)):(this._selection=this.selectionFactory(i,this.options.selectionStyle,this._layer).addTo(this._map),this._startMarker.bringToFront(),this._endMarker.bringToFront()),this.fire("selection")},_onMousemove:function(t){var e=this._getNearestPoint(t.latlng);this._dragging?(e&&(this._dragging.start=e.start,this._dragging.end=e.end,this._dragging.setLatLng(e)),this._startMarker&&this._endMarker&&this._onSelect(),i.clearTimeout(this._dragTimer),this._dragTimer=i.setTimeout(this._stopHandlerDrag.bind(this,t),750)):e&&(this._movingMarker.setLatLng(e),this._movingMarker.start=e.start,this._movingMarker.end=e.end)},_getNearestPoint:function(t,e){var i=this._getPointerBounds(t,e),n=this._tree.search(i);if(0!==n.length){var o=this._feature.geometry.coordinates,s=Number.MAX_VALUE,a=[t.lng,t.lat],l=n[0].start,h=n[0].end,c=o[l],_=o[h];if(n.length>1)for(var d=0,u=n.length;d<u;d++){var g=o[n[d].start],f=o[n[d].end],p=r.pointSegmentDistance(a,g,f);p<s&&(s=p,c=g,_=f,l=n[d].start,h=n[d].end)}return a=r.closestPointOnSegment(a,c,_),a=[a[1],a[0]],a.start=l,a.end=h,a}return null},_buildTree:function(){var t=this._feature.geometry.coordinates,e=[];this._tree?this._tree.clear():this._tree=l(9,["[0]","[1]","[2]","[3]"]);for(var i=1,n=t.length;i<n;i++){var r=this._toTreeNode(t[i-1],t[i]);r.start=i-1,r.end=i,e.push(r)}this._tree.load(e)},_toTreeNode:function(t,e){var i=t[0],n=e[0],r=t[1],o=e[1];return i>n&&(n=t[0],i=e[0]),r>o&&(o=t[1],r=e[1]),[i,r,n,o]}});e.exports=h}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./endpoint":2,"./geometry":3,"./marker":4,"./selection":6,rbush:void 0}],6:[function(t,e,i){(function(t){var i="undefined"!=typeof window?window.L:"undefined"!=typeof t?t.L:null,n=i.Polyline.extend({initialize:function(t,e,n){this._source=n,i.Polyline.prototype.initialize.call(this,t,e)},updatePathFromSource:function(t,e){this._originalPoints=this._source._originalPoints.slice(t,e+1),this._originalPoints.unshift(this._map.latLngToLayerPoint(this._latlngs[0])),this._originalPoints.push(this._map.latLngToLayerPoint(this._latlngs[this._latlngs.length-1])),this._updatePath()}});e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1])(1)});
